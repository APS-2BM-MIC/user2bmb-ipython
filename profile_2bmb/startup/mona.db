# file: mona.db
# purpose: provide PVs for MONA modules to advise BlueSky
# to run:  ./run_mona_ioc.sh


#The configured quality checks are:
#
#"data" : [ "mean", "st_dev", "stat_mean"]

record(bo, "mona:StopAcquisition") {
    # MONA module will set this
    # BlueSky will clear this once acquisition has been stopped
    field(DESC, "MONA modules wants scan to end")
    field(ZNAM, "Ok")
    field(ONAM, "Stop")
}

record(ao, "2bmbPG3:data_mean_ctr") {
    # number of frames that have failed the mean quality check
    field(DESC, "PG3 failed failed mean quality check")
}

record(ao, "2bmbPG3:data_mean_res") {
    field(DESC, "PG3 ...")
}

record(ao, "2bmbPG3:data_st_dev_ctr") {
    field(DESC, "PG3 ...")
}

record(ao, "2bmbPG3:data_st_dev_res") {
    field(DESC, "PG3 ...")
}

record(ao, "2bmbPG3:data_stat_mean_ctr") {
    field(DESC, "PG3 ...")
}

record(ao, "2bmbPG3:data_stat_mean_res") {
    field(DESC, "PG3 ...")
}


# -----------------------------------
# temporary, until ioc2bmb is rebooted with this PV

#  P=2bmb:
#  Q=DX:
# 
# defines PVs to be included in Tomography DataExchange HDF5 files


# Contains (expected) theta (rotation angle) values for next tomo scan.
# Written by data acq software such as Bluesky.
record(waveform, "2bmb:DX:theta") {
  field(DESC, "pre-computed theta angles")
  field(DTYP, "Soft Channel")
  field(EGU,  "degrees")
  field(FTVL, "DOUBLE")
  field(NELM, "9999")
}

